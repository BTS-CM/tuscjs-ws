(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.tusc_ws = f()}})(function(){var define,module,exports;return (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.setRpcConnectionStatusCallback=exports.setAutoReconnect=exports.reset=exports.orders=exports.network=exports.instance=exports.history=exports.db=exports.crypto=exports.close=exports.chainId=void 0;var _ChainWebSocket=_interopRequireDefault(require("./ChainWebSocket")),_GrapheneApi=_interopRequireDefault(require("./GrapheneApi")),_ChainConfig=_interopRequireDefault(require("./ChainConfig"));function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}var autoReconnect=!1,Apis=null,statusCb=null;// by default don't use reconnecting-websocket
const setRpcConnectionStatusCallback=a=>{statusCb=a,Apis&&Apis.setRpcConnectionStatusCallback(a)};exports.setRpcConnectionStatusCallback=setRpcConnectionStatusCallback;const setAutoReconnect=a=>{autoReconnect=a};exports.setAutoReconnect=setAutoReconnect;const reset=function(){let a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:"ws://localhost:8090",b=1<arguments.length?arguments[1]:void 0,c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:4e3,d=3<arguments.length?arguments[3]:void 0,e=4<arguments.length?arguments[4]:void 0;return close().then(()=>(Apis=newApis(),Apis.setRpcConnectionStatusCallback(statusCb),Apis&&b&&Apis.connect(a,c,d,e),Apis))};exports.reset=reset;const instance=function(){let a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"ws://localhost:8090",b=1<arguments.length?arguments[1]:void 0,c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:4e3,d=3<arguments.length?arguments[3]:void 0,e=4<arguments.length?arguments[4]:void 0;return Apis||(Apis=newApis(),Apis.setRpcConnectionStatusCallback(statusCb)),Apis&&b&&Apis.connect(a,c,d),e&&(Apis.closeCb=e),Apis};exports.instance=instance;const chainId=()=>instance().chain_id;exports.chainId=chainId;const close=async()=>{Apis&&(await Apis.close(),Apis=null)};exports.close=close;const get=a=>new Proxy([],{get:(b,c)=>function(){for(var b=arguments.length,d=Array(b),e=0;e<b;e++)d[e]=arguments[e];return Apis[a].exec(c,[...d])}}),db=get("_db");exports.db=db;const network=get("_net");exports.network=network;const history=get("_hist");exports.history=history;const crypto=get("_crypt");exports.crypto=crypto;const orders=get("_orders");exports.orders=orders;const newApis=()=>({connect:function(a,b){let c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:{enableCrypto:!1,enableOrders:!1};Apis.url=a;if("undefined"!=typeof window&&window.location&&"https:"===window.location.protocol&&0>a.indexOf("wss://"))throw new Error("Secure domains require wss connection");Apis.ws_rpc&&(Apis.ws_rpc.statusCb=null,Apis.ws_rpc.keepAliveCb=null,Apis.ws_rpc.on_close=null,Apis.ws_rpc.on_reconnect=null),Apis.ws_rpc=new _ChainWebSocket.default(a,Apis.statusCb,b,autoReconnect,a=>{Apis._db&&!a&&Apis._db.exec("get_objects",[["2.1.0"]]).catch(()=>{})}),Apis.init_promise=Apis.ws_rpc.login("","").then(()=>{Apis._db=new _GrapheneApi.default(Apis.ws_rpc,"database"),Apis._net=new _GrapheneApi.default(Apis.ws_rpc,"network_broadcast"),Apis._hist=new _GrapheneApi.default(Apis.ws_rpc,"history"),c.enableOrders&&(Apis._orders=new _GrapheneApi.default(Apis.ws_rpc,"orders")),c.enableCrypto&&(Apis._crypt=new _GrapheneApi.default(Apis.ws_rpc,"crypto"));var a=Apis._db.init().then(()=>Apis._db.exec("get_chain_id",[]).then(a=>(Apis.chain_id=a,_ChainConfig.default.setChainId(a))));Apis.ws_rpc.on_reconnect=()=>{Apis.ws_rpc&&Apis.ws_rpc.login("","").then(()=>{Apis._db.init().then(()=>{Apis.statusCb&&Apis.statusCb("reconnect")}),Apis._net.init(),Apis._hist.init(),c.enableOrders&&Apis._orders.init(),c.enableCrypto&&Apis._crypt.init()})},Apis.ws_rpc.on_close=()=>{Apis.close().then(()=>{Apis.closeCb&&Apis.closeCb()})};let b=[a,Apis._net.init(),Apis._hist.init()];return c.enableOrders&&b.push(Apis._orders.init()),c.enableCrypto&&b.push(Apis._crypt.init()),Promise.all(b)}).catch(b=>(console.error(a,"Failed to initialize with error",b&&b.message),Apis.close().then(()=>{throw b})))},close:async()=>{Apis.ws_rpc&&1===Apis.ws_rpc.ws.readyState&&(await Apis.ws_rpc.close()),Apis.ws_rpc=null},db_api:()=>Apis._db,network_api:()=>Apis._net,history_api:()=>Apis._hist,crypto_api:()=>Apis._crypt,orders_api:()=>Apis._orders,setRpcConnectionStatusCallback:a=>Apis.statusCb=a});
},{"./ChainConfig":2,"./ChainWebSocket":3,"./GrapheneApi":5}],2:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var config={core_asset:"CORE",address_prefix:"GPH",expire_in_secs:15,expire_in_secs_proposal:86400,review_in_secs_committee:86400,networks:{TUSC:{core_asset:"TUSC",address_prefix:"TUSC",chain_id:"eb938e2a955e39e335120d0a99f3b9f8c04a9ed5690275ea5037d6bbadfc6cf3"},TUSC_Test:{core_asset:"TUSC",address_prefix:"TUSC",chain_id:"20ef1e234daf7844e4e8cd03423d5ae80cc0415319a4e5984cf302bf6cc00a1b"}},/** Set a few properties for known chain IDs. */setChainId:a=>{let b=Object.entries(config.networks).find(b=>{let[c,d]=b;if(d.chain_id===a)return config.network_name=c,d.address_prefix&&(config.address_prefix=d.address_prefix),!0});return b?{network_name:b[0],network:b[1]}:void console.log("Unknown chain id (this may be a testnet)",a)},reset:()=>{config.core_asset="CORE",config.address_prefix="GPH",config.expire_in_secs=15,config.expire_in_secs_proposal=86400,console.log("Chain config reset")},setPrefix:function(){let a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:"GPH";return config.address_prefix=a}},_default=config;exports.default=_default;
},{}],3:[function(require,module,exports){
"use strict";var _isomorphicWs=_interopRequireDefault(require("isomorphic-ws"));Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}function _defineProperty(a,b,c){return b=_toPropertyKey(b),b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function _toPropertyKey(a){var b=_toPrimitive(a,"string");return"symbol"==typeof b?b:b+""}function _toPrimitive(a,b){if("object"!=typeof a||null===a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var d=c.call(a,b||"default");if("object"!=typeof d)return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===b?String:Number)(a)}const SOCKET_DEBUG=!1,MAX_SEND_LIFE=5,MAX_RECV_LIFE=2*MAX_SEND_LIFE;class ChainWebSocket{constructor(a,b){let c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:5e3,d=!(3<arguments.length&&arguments[3]!==void 0)||arguments[3],e=4<arguments.length&&arguments[4]!==void 0?arguments[4]:null;_defineProperty(this,"connect",(a,b)=>new Promise((c,d)=>{this.current_reject=d,this.current_resolve=c;try{this.ws=new _isomorphicWs.default(a)}catch(b){// DISCONNECTED
this.ws={readyState:3,close:()=>{}},d(new Error("Invalid url",a," closed"))}this.ws.onopen=this.onOpen,this.ws.onerror=this.onError,this.ws.onmessage=this.onMessage,this.ws.onclose=this.onClose,this.connectionTimeout=setTimeout(()=>{this.current_reject&&(this.current_reject=null,this.close(),d(new Error("Connection attempt timed out after "+b/1e3+"s")))},b)})),_defineProperty(this,"onOpen",()=>{clearTimeout(this.connectionTimeout),this.statusCb&&this.statusCb("open"),this.on_reconnect&&this.on_reconnect(),this.keepalive_timer=setInterval(()=>(this.recv_life--,0==this.recv_life?(console.error(this.url+" connection is dead, terminating ws"),void this.close()):void(this.send_life--,0==this.send_life&&(this.keepAliveCb&&this.keepAliveCb(this.closed),this.send_life=MAX_SEND_LIFE))),5e3),this.current_reject=null,this.current_resolve()}),_defineProperty(this,"onError",a=>{this.keepalive_timer&&(clearInterval(this.keepalive_timer),this.keepalive_timer=void 0),clearTimeout(this.connectionTimeout),this.statusCb&&this.statusCb("error"),this.current_reject&&this.current_reject(a)}),_defineProperty(this,"onMessage",a=>{this.recv_life=MAX_RECV_LIFE,this.listener(JSON.parse(a.data))}),_defineProperty(this,"onClose",()=>{this.closed=!0,this.keepalive_timer&&(clearInterval(this.keepalive_timer),this.keepalive_timer=void 0);for(var a=this.responseCbId+1;a<=this.cbId;a+=1)this.cbs[a].reject(new Error("connection closed"));this.statusCb&&this.statusCb("closed"),this._closeCb&&this._closeCb(),this.on_close&&this.on_close()}),_defineProperty(this,"call",a=>{if(1!==this.ws.readyState)return Promise.reject(new Error("websocket state error:"+this.ws.readyState));let b=a[1];if(SOCKET_DEBUG&&console.log("[ChainWebSocket] >---- call ----->  \"id\":"+(this.cbId+1),JSON.stringify(a)),this.cbId+=1,["set_subscribe_callback","subscribe_to_market","broadcast_transaction_with_callback","set_pending_transaction_callback","set_block_applied_callback"].includes(b)&&(this.subs[this.cbId]={callback:a[2][0]},a[2][0]=this.cbId),["unsubscribe_from_market","unsubscribe_from_accounts"].includes(b)){if("function"!=typeof a[2][0])throw new Error("First parameter of unsub must be the original callback");let b=a[2].splice(0,1)[0];// Find the corresponding subscription
for(let a in this.subs)if(this.subs[a].callback===b){this.unsub[this.cbId]=a;break}}var c={method:"call",params:a};return c.id=this.cbId,this.send_life=MAX_SEND_LIFE,new Promise((a,b)=>{this.cbs[this.cbId]={time:new Date,resolve:a,reject:b},this.ws.send(JSON.stringify(c))})}),_defineProperty(this,"listener",a=>{SOCKET_DEBUG&&console.log("[ChainWebSocket] <---- reply ----<",JSON.stringify(a));let b=!1,c=null;"notice"===a.method&&(b=!0,a.id=a.params[0]),b?c=this.subs[a.id].callback:(c=this.cbs[a.id],this.responseCbId=a.id),c&&!b?(a.error?c.reject(a.error):c.resolve(a.result),delete this.cbs[a.id],this.unsub[a.id]&&(delete this.subs[this.unsub[a.id]],delete this.unsub[a.id])):c&&b?c(a.params[1]):console.log("Warning: unknown websocket response: ",a)}),_defineProperty(this,"login",(a,b)=>this.connect_promise.then(()=>this.call([1,"login",[a,b]]))),_defineProperty(this,"close",()=>new Promise(a=>(clearInterval(this.keepalive_timer),this.keepalive_timer=void 0,this._closeCb=()=>{a(),this._closeCb=null},this.ws?void(this.ws.terminate?this.ws.terminate():this.ws.close(),3===this.ws.readyState&&a()):(console.log("Websocket already cleared",this),a())))),this.url=a,this.statusCb=b,this.current_reject=null,this.on_reconnect=null,this.closed=!1,this.send_life=MAX_SEND_LIFE,this.recv_life=MAX_RECV_LIFE,this.keepAliveCb=e,this.cbId=0,this.responseCbId=0,this.cbs={},this.subs={},this.unsub={},this.connect_promise=this.connect(a,c)}}var _default=ChainWebSocket;exports.default=_default;
},{"isomorphic-ws":7}],4:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var Apis=_interopRequireWildcard(require("./ApiInstances")),_ChainWebSocket=_interopRequireDefault(require("./ChainWebSocket"));function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}function _getRequireWildcardCache(a){if("function"!=typeof WeakMap)return null;var b=new WeakMap,c=new WeakMap;return(_getRequireWildcardCache=function(a){return a?c:b})(a)}function _interopRequireWildcard(a,b){if(!b&&a&&a.__esModule)return a;if(null===a||"object"!=typeof a&&"function"!=typeof a)return{default:a};var c=_getRequireWildcardCache(b);if(c&&c.has(a))return c.get(a);var d={},e=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var f in a)if("default"!=f&&Object.prototype.hasOwnProperty.call(a,f)){var g=e?Object.getOwnPropertyDescriptor(a,f):null;g&&(g.get||g.set)?Object.defineProperty(d,f,g):d[f]=a[f]}return d.default=a,c&&c.set(a,d),d}function _defineProperty(a,b,c){return b=_toPropertyKey(b),b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function _toPropertyKey(a){var b=_toPrimitive(a,"string");return"symbol"==typeof b?b:b+""}function _toPrimitive(a,b){if("object"!=typeof a||null===a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var d=c.call(a,b||"default");if("object"!=typeof d)return d;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===b?String:Number)(a)}class Manager{constructor(a){var b=this;let{url:c,urls:d,autoFallback:e,closeCb:f,optionalApis:g,urlChangeCallback:h}=a;_defineProperty(this,"setCloseCb",a=>{this.closeCb=a}),_defineProperty(this,"logFailure",(a,b,c)=>{let d=c&&c.message?c.message:"";console.error(a,"Failed to connect to "+b+(d?" Error: "+JSON.stringify(d):""))}),_defineProperty(this,"_onClose",()=>{this.isConnected=!1,this.closeCb&&(this.closeCb(),this.setCloseCb(null)),this.autoFallback&&this.connectWithFallback()}),_defineProperty(this,"connect",async function(){let a=!(0<arguments.length&&arguments[0]!==void 0)||arguments[0],c=1<arguments.length&&arguments[1]!==void 0?arguments[1]:b.url;try{let d=await Apis.instance(c,a,void 0,b.optionalApis,b._onClose).init_promise;return b.url=c,b.isConnected=!0,d}catch(a){throw await Apis.close(),a}}),_defineProperty(this,"connectWithFallback",async function(){let a=!(0<arguments.length&&arguments[0]!==void 0)||arguments[0],c=1<arguments.length&&arguments[1]!==void 0?arguments[1]:b.url,d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:0,e=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null,f=4<arguments.length&&arguments[4]!==void 0?arguments[4]:null;if(d>b.urls.length)return f(new Error("Tried "+d+" connections, none of which worked: "+JSON.stringify(b.urls.concat(b.url))));try{return await b.connect(a,c)}catch(c){return b.urlChangeCallback&&b.urlChangeCallback(b.urls[d]),b.connectWithFallback(a,b.urls[d],d+1,e,f)}}),_defineProperty(this,"checkConnections",async function(){let a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:"",c=1<arguments.length&&arguments[1]!==void 0?arguments[1]:"",d=2<arguments.length?arguments[2]:void 0,e=3<arguments.length?arguments[3]:void 0,f={},g=b.urls.concat(b.url),h=g.map(async d=>{/* Use default timeout and no reconnecting-websocket */let e=new _ChainWebSocket.default(d,()=>{},void 0,!1);f[d]=new Date().getTime();try{await e.login(a,c);let b={[d]:new Date().getTime()-f[d]};return await e.close(),b}catch(a){return d===b.url?b.url=b.urls[0]:b.urls=b.urls.filter(b=>b!==d),void(await e.close())}});try{let a=await Promise.all(h),b=a.filter(b=>!!b).sort((c,a)=>Object.values(c)[0]-Object.values(a)[0]).reduce((b,c)=>{let a=Object.keys(c)[0];return b[a]=c[a],b},{});return console.log(`Checked ${a.length} connections, ${a.length-Object.keys(b).length} failed`),b}catch(f){return b.checkConnections(a,c,d,e)}}),this.url=c,this.urls=d.filter(b=>b!==c),this.autoFallback=e,this.closeCb=f,this.optionalApis=g||{},this.isConnected=!1,this.urlChangeCallback=h}static close(){return Apis.close()}}var _default=Manager;exports.default=_default;
},{"./ApiInstances":1,"./ChainWebSocket":3}],5:[function(require,module,exports){
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;class GrapheneApi{constructor(a,b){this.ws_rpc=a,this.api_name=b}init(){var a=this;return this.ws_rpc.call([1,this.api_name,[]]).then(b=>(a.api_id=b,a))}exec(a,b){return this.ws_rpc.call([this.api_id,a,b]).catch(a=>{// console.log("!!! GrapheneApi error: ", method, params, error, JSON.stringify(error));
throw a})}}var _default=GrapheneApi;exports.default=_default;
},{}],6:[function(require,module,exports){
"use strict";var Apis=_interopRequireWildcard(require("./ApiInstances"));Object.defineProperty(exports,"__esModule",{value:!0}),exports.Apis=void 0,Object.defineProperty(exports,"ChainConfig",{enumerable:!0,get:function(){return _ChainConfig.default}}),Object.defineProperty(exports,"Manager",{enumerable:!0,get:function(){return _ConnectionManager.default}});exports.Apis=Apis;var _ConnectionManager=_interopRequireDefault(require("./ConnectionManager")),_ChainConfig=_interopRequireDefault(require("./ChainConfig"));function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}function _getRequireWildcardCache(a){if("function"!=typeof WeakMap)return null;var b=new WeakMap,c=new WeakMap;return(_getRequireWildcardCache=function(a){return a?c:b})(a)}function _interopRequireWildcard(a,b){if(!b&&a&&a.__esModule)return a;if(null===a||"object"!=typeof a&&"function"!=typeof a)return{default:a};var c=_getRequireWildcardCache(b);if(c&&c.has(a))return c.get(a);var d={},e=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var f in a)if("default"!=f&&Object.prototype.hasOwnProperty.call(a,f)){var g=e?Object.getOwnPropertyDescriptor(a,f):null;g&&(g.get||g.set)?Object.defineProperty(d,f,g):d[f]=a[f]}return d.default=a,c&&c.set(a,d),d}
},{"./ApiInstances":1,"./ChainConfig":2,"./ConnectionManager":4}],7:[function(require,module,exports){
(function (global){(function (){
// https://github.com/maxogden/websocket-stream/blob/48dc3ddf943e5ada668c31ccd94e9186f02fafbd/ws-fallback.js

var ws = null

if (typeof WebSocket !== 'undefined') {
  ws = WebSocket
} else if (typeof MozWebSocket !== 'undefined') {
  ws = MozWebSocket
} else if (typeof global !== 'undefined') {
  ws = global.WebSocket || global.MozWebSocket
} else if (typeof window !== 'undefined') {
  ws = window.WebSocket || window.MozWebSocket
} else if (typeof self !== 'undefined') {
  ws = self.WebSocket || self.MozWebSocket
}

module.exports = ws

}).call(this)}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}]},{},[6])(6)
});

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJsaWIvQXBpSW5zdGFuY2VzLmpzIiwibGliL0NoYWluQ29uZmlnLmpzIiwibGliL0NoYWluV2ViU29ja2V0LmpzIiwibGliL0Nvbm5lY3Rpb25NYW5hZ2VyLmpzIiwibGliL0dyYXBoZW5lQXBpLmpzIiwibGliL2luZGV4LmpzIiwibm9kZV9tb2R1bGVzL2lzb21vcnBoaWMtd3MvYnJvd3Nlci5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FBQ0E7O0FDREE7O0FDQUE7QUFDQTtBQUNBOztBQ0ZBOztBQ0FBO0FBQ0E7O0FDREE7OztBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gcihlLG4sdCl7ZnVuY3Rpb24gbyhpLGYpe2lmKCFuW2ldKXtpZighZVtpXSl7dmFyIGM9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZTtpZighZiYmYylyZXR1cm4gYyhpLCEwKTtpZih1KXJldHVybiB1KGksITApO3ZhciBhPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIraStcIidcIik7dGhyb3cgYS5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGF9dmFyIHA9bltpXT17ZXhwb3J0czp7fX07ZVtpXVswXS5jYWxsKHAuZXhwb3J0cyxmdW5jdGlvbihyKXt2YXIgbj1lW2ldWzFdW3JdO3JldHVybiBvKG58fHIpfSxwLHAuZXhwb3J0cyxyLGUsbix0KX1yZXR1cm4gbltpXS5leHBvcnRzfWZvcih2YXIgdT1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlLGk9MDtpPHQubGVuZ3RoO2krKylvKHRbaV0pO3JldHVybiBvfXJldHVybiByfSkoKSIsIlwidXNlIHN0cmljdFwiO09iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLFwiX19lc01vZHVsZVwiLHt2YWx1ZTohMH0pLGV4cG9ydHMuc2V0UnBjQ29ubmVjdGlvblN0YXR1c0NhbGxiYWNrPWV4cG9ydHMuc2V0QXV0b1JlY29ubmVjdD1leHBvcnRzLnJlc2V0PWV4cG9ydHMub3JkZXJzPWV4cG9ydHMubmV0d29yaz1leHBvcnRzLmluc3RhbmNlPWV4cG9ydHMuaGlzdG9yeT1leHBvcnRzLmRiPWV4cG9ydHMuY3J5cHRvPWV4cG9ydHMuY2xvc2U9ZXhwb3J0cy5jaGFpbklkPXZvaWQgMDt2YXIgX0NoYWluV2ViU29ja2V0PV9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vQ2hhaW5XZWJTb2NrZXRcIikpLF9HcmFwaGVuZUFwaT1faW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuL0dyYXBoZW5lQXBpXCIpKSxfQ2hhaW5Db25maWc9X2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiLi9DaGFpbkNvbmZpZ1wiKSk7ZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChhKXtyZXR1cm4gYSYmYS5fX2VzTW9kdWxlP2E6e2RlZmF1bHQ6YX19dmFyIGF1dG9SZWNvbm5lY3Q9ITEsQXBpcz1udWxsLHN0YXR1c0NiPW51bGw7Ly8gYnkgZGVmYXVsdCBkb24ndCB1c2UgcmVjb25uZWN0aW5nLXdlYnNvY2tldFxuY29uc3Qgc2V0UnBjQ29ubmVjdGlvblN0YXR1c0NhbGxiYWNrPWE9PntzdGF0dXNDYj1hLEFwaXMmJkFwaXMuc2V0UnBjQ29ubmVjdGlvblN0YXR1c0NhbGxiYWNrKGEpfTtleHBvcnRzLnNldFJwY0Nvbm5lY3Rpb25TdGF0dXNDYWxsYmFjaz1zZXRScGNDb25uZWN0aW9uU3RhdHVzQ2FsbGJhY2s7Y29uc3Qgc2V0QXV0b1JlY29ubmVjdD1hPT57YXV0b1JlY29ubmVjdD1hfTtleHBvcnRzLnNldEF1dG9SZWNvbm5lY3Q9c2V0QXV0b1JlY29ubmVjdDtjb25zdCByZXNldD1mdW5jdGlvbigpe2xldCBhPTA8YXJndW1lbnRzLmxlbmd0aCYmYXJndW1lbnRzWzBdIT09dm9pZCAwP2FyZ3VtZW50c1swXTpcIndzOi8vbG9jYWxob3N0OjgwOTBcIixiPTE8YXJndW1lbnRzLmxlbmd0aD9hcmd1bWVudHNbMV06dm9pZCAwLGM9Mjxhcmd1bWVudHMubGVuZ3RoJiZhcmd1bWVudHNbMl0hPT12b2lkIDA/YXJndW1lbnRzWzJdOjRlMyxkPTM8YXJndW1lbnRzLmxlbmd0aD9hcmd1bWVudHNbM106dm9pZCAwLGU9NDxhcmd1bWVudHMubGVuZ3RoP2FyZ3VtZW50c1s0XTp2b2lkIDA7cmV0dXJuIGNsb3NlKCkudGhlbigoKT0+KEFwaXM9bmV3QXBpcygpLEFwaXMuc2V0UnBjQ29ubmVjdGlvblN0YXR1c0NhbGxiYWNrKHN0YXR1c0NiKSxBcGlzJiZiJiZBcGlzLmNvbm5lY3QoYSxjLGQsZSksQXBpcykpfTtleHBvcnRzLnJlc2V0PXJlc2V0O2NvbnN0IGluc3RhbmNlPWZ1bmN0aW9uKCl7bGV0IGE9MDxhcmd1bWVudHMubGVuZ3RoJiZ2b2lkIDAhPT1hcmd1bWVudHNbMF0/YXJndW1lbnRzWzBdOlwid3M6Ly9sb2NhbGhvc3Q6ODA5MFwiLGI9MTxhcmd1bWVudHMubGVuZ3RoP2FyZ3VtZW50c1sxXTp2b2lkIDAsYz0yPGFyZ3VtZW50cy5sZW5ndGgmJnZvaWQgMCE9PWFyZ3VtZW50c1syXT9hcmd1bWVudHNbMl06NGUzLGQ9Mzxhcmd1bWVudHMubGVuZ3RoP2FyZ3VtZW50c1szXTp2b2lkIDAsZT00PGFyZ3VtZW50cy5sZW5ndGg/YXJndW1lbnRzWzRdOnZvaWQgMDtyZXR1cm4gQXBpc3x8KEFwaXM9bmV3QXBpcygpLEFwaXMuc2V0UnBjQ29ubmVjdGlvblN0YXR1c0NhbGxiYWNrKHN0YXR1c0NiKSksQXBpcyYmYiYmQXBpcy5jb25uZWN0KGEsYyxkKSxlJiYoQXBpcy5jbG9zZUNiPWUpLEFwaXN9O2V4cG9ydHMuaW5zdGFuY2U9aW5zdGFuY2U7Y29uc3QgY2hhaW5JZD0oKT0+aW5zdGFuY2UoKS5jaGFpbl9pZDtleHBvcnRzLmNoYWluSWQ9Y2hhaW5JZDtjb25zdCBjbG9zZT1hc3luYygpPT57QXBpcyYmKGF3YWl0IEFwaXMuY2xvc2UoKSxBcGlzPW51bGwpfTtleHBvcnRzLmNsb3NlPWNsb3NlO2NvbnN0IGdldD1hPT5uZXcgUHJveHkoW10se2dldDooYixjKT0+ZnVuY3Rpb24oKXtmb3IodmFyIGI9YXJndW1lbnRzLmxlbmd0aCxkPUFycmF5KGIpLGU9MDtlPGI7ZSsrKWRbZV09YXJndW1lbnRzW2VdO3JldHVybiBBcGlzW2FdLmV4ZWMoYyxbLi4uZF0pfX0pLGRiPWdldChcIl9kYlwiKTtleHBvcnRzLmRiPWRiO2NvbnN0IG5ldHdvcms9Z2V0KFwiX25ldFwiKTtleHBvcnRzLm5ldHdvcms9bmV0d29yaztjb25zdCBoaXN0b3J5PWdldChcIl9oaXN0XCIpO2V4cG9ydHMuaGlzdG9yeT1oaXN0b3J5O2NvbnN0IGNyeXB0bz1nZXQoXCJfY3J5cHRcIik7ZXhwb3J0cy5jcnlwdG89Y3J5cHRvO2NvbnN0IG9yZGVycz1nZXQoXCJfb3JkZXJzXCIpO2V4cG9ydHMub3JkZXJzPW9yZGVycztjb25zdCBuZXdBcGlzPSgpPT4oe2Nvbm5lY3Q6ZnVuY3Rpb24oYSxiKXtsZXQgYz0yPGFyZ3VtZW50cy5sZW5ndGgmJmFyZ3VtZW50c1syXSE9PXZvaWQgMD9hcmd1bWVudHNbMl06e2VuYWJsZUNyeXB0bzohMSxlbmFibGVPcmRlcnM6ITF9O0FwaXMudXJsPWE7aWYoXCJ1bmRlZmluZWRcIiE9dHlwZW9mIHdpbmRvdyYmd2luZG93LmxvY2F0aW9uJiZcImh0dHBzOlwiPT09d2luZG93LmxvY2F0aW9uLnByb3RvY29sJiYwPmEuaW5kZXhPZihcIndzczovL1wiKSl0aHJvdyBuZXcgRXJyb3IoXCJTZWN1cmUgZG9tYWlucyByZXF1aXJlIHdzcyBjb25uZWN0aW9uXCIpO0FwaXMud3NfcnBjJiYoQXBpcy53c19ycGMuc3RhdHVzQ2I9bnVsbCxBcGlzLndzX3JwYy5rZWVwQWxpdmVDYj1udWxsLEFwaXMud3NfcnBjLm9uX2Nsb3NlPW51bGwsQXBpcy53c19ycGMub25fcmVjb25uZWN0PW51bGwpLEFwaXMud3NfcnBjPW5ldyBfQ2hhaW5XZWJTb2NrZXQuZGVmYXVsdChhLEFwaXMuc3RhdHVzQ2IsYixhdXRvUmVjb25uZWN0LGE9PntBcGlzLl9kYiYmIWEmJkFwaXMuX2RiLmV4ZWMoXCJnZXRfb2JqZWN0c1wiLFtbXCIyLjEuMFwiXV0pLmNhdGNoKCgpPT57fSl9KSxBcGlzLmluaXRfcHJvbWlzZT1BcGlzLndzX3JwYy5sb2dpbihcIlwiLFwiXCIpLnRoZW4oKCk9PntBcGlzLl9kYj1uZXcgX0dyYXBoZW5lQXBpLmRlZmF1bHQoQXBpcy53c19ycGMsXCJkYXRhYmFzZVwiKSxBcGlzLl9uZXQ9bmV3IF9HcmFwaGVuZUFwaS5kZWZhdWx0KEFwaXMud3NfcnBjLFwibmV0d29ya19icm9hZGNhc3RcIiksQXBpcy5faGlzdD1uZXcgX0dyYXBoZW5lQXBpLmRlZmF1bHQoQXBpcy53c19ycGMsXCJoaXN0b3J5XCIpLGMuZW5hYmxlT3JkZXJzJiYoQXBpcy5fb3JkZXJzPW5ldyBfR3JhcGhlbmVBcGkuZGVmYXVsdChBcGlzLndzX3JwYyxcIm9yZGVyc1wiKSksYy5lbmFibGVDcnlwdG8mJihBcGlzLl9jcnlwdD1uZXcgX0dyYXBoZW5lQXBpLmRlZmF1bHQoQXBpcy53c19ycGMsXCJjcnlwdG9cIikpO3ZhciBhPUFwaXMuX2RiLmluaXQoKS50aGVuKCgpPT5BcGlzLl9kYi5leGVjKFwiZ2V0X2NoYWluX2lkXCIsW10pLnRoZW4oYT0+KEFwaXMuY2hhaW5faWQ9YSxfQ2hhaW5Db25maWcuZGVmYXVsdC5zZXRDaGFpbklkKGEpKSkpO0FwaXMud3NfcnBjLm9uX3JlY29ubmVjdD0oKT0+e0FwaXMud3NfcnBjJiZBcGlzLndzX3JwYy5sb2dpbihcIlwiLFwiXCIpLnRoZW4oKCk9PntBcGlzLl9kYi5pbml0KCkudGhlbigoKT0+e0FwaXMuc3RhdHVzQ2ImJkFwaXMuc3RhdHVzQ2IoXCJyZWNvbm5lY3RcIil9KSxBcGlzLl9uZXQuaW5pdCgpLEFwaXMuX2hpc3QuaW5pdCgpLGMuZW5hYmxlT3JkZXJzJiZBcGlzLl9vcmRlcnMuaW5pdCgpLGMuZW5hYmxlQ3J5cHRvJiZBcGlzLl9jcnlwdC5pbml0KCl9KX0sQXBpcy53c19ycGMub25fY2xvc2U9KCk9PntBcGlzLmNsb3NlKCkudGhlbigoKT0+e0FwaXMuY2xvc2VDYiYmQXBpcy5jbG9zZUNiKCl9KX07bGV0IGI9W2EsQXBpcy5fbmV0LmluaXQoKSxBcGlzLl9oaXN0LmluaXQoKV07cmV0dXJuIGMuZW5hYmxlT3JkZXJzJiZiLnB1c2goQXBpcy5fb3JkZXJzLmluaXQoKSksYy5lbmFibGVDcnlwdG8mJmIucHVzaChBcGlzLl9jcnlwdC5pbml0KCkpLFByb21pc2UuYWxsKGIpfSkuY2F0Y2goYj0+KGNvbnNvbGUuZXJyb3IoYSxcIkZhaWxlZCB0byBpbml0aWFsaXplIHdpdGggZXJyb3JcIixiJiZiLm1lc3NhZ2UpLEFwaXMuY2xvc2UoKS50aGVuKCgpPT57dGhyb3cgYn0pKSl9LGNsb3NlOmFzeW5jKCk9PntBcGlzLndzX3JwYyYmMT09PUFwaXMud3NfcnBjLndzLnJlYWR5U3RhdGUmJihhd2FpdCBBcGlzLndzX3JwYy5jbG9zZSgpKSxBcGlzLndzX3JwYz1udWxsfSxkYl9hcGk6KCk9PkFwaXMuX2RiLG5ldHdvcmtfYXBpOigpPT5BcGlzLl9uZXQsaGlzdG9yeV9hcGk6KCk9PkFwaXMuX2hpc3QsY3J5cHRvX2FwaTooKT0+QXBpcy5fY3J5cHQsb3JkZXJzX2FwaTooKT0+QXBpcy5fb3JkZXJzLHNldFJwY0Nvbm5lY3Rpb25TdGF0dXNDYWxsYmFjazphPT5BcGlzLnN0YXR1c0NiPWF9KTsiLCJcInVzZSBzdHJpY3RcIjtPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cyxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KSxleHBvcnRzLmRlZmF1bHQ9dm9pZCAwO3ZhciBjb25maWc9e2NvcmVfYXNzZXQ6XCJDT1JFXCIsYWRkcmVzc19wcmVmaXg6XCJHUEhcIixleHBpcmVfaW5fc2VjczoxNSxleHBpcmVfaW5fc2Vjc19wcm9wb3NhbDo4NjQwMCxyZXZpZXdfaW5fc2Vjc19jb21taXR0ZWU6ODY0MDAsbmV0d29ya3M6e1RVU0M6e2NvcmVfYXNzZXQ6XCJUVVNDXCIsYWRkcmVzc19wcmVmaXg6XCJUVVNDXCIsY2hhaW5faWQ6XCJlYjkzOGUyYTk1NWUzOWUzMzUxMjBkMGE5OWYzYjlmOGMwNGE5ZWQ1NjkwMjc1ZWE1MDM3ZDZiYmFkZmM2Y2YzXCJ9LFRVU0NfVGVzdDp7Y29yZV9hc3NldDpcIlRVU0NcIixhZGRyZXNzX3ByZWZpeDpcIlRVU0NcIixjaGFpbl9pZDpcIjIwZWYxZTIzNGRhZjc4NDRlNGU4Y2QwMzQyM2Q1YWU4MGNjMDQxNTMxOWE0ZTU5ODRjZjMwMmJmNmNjMDBhMWJcIn19LC8qKiBTZXQgYSBmZXcgcHJvcGVydGllcyBmb3Iga25vd24gY2hhaW4gSURzLiAqL3NldENoYWluSWQ6YT0+e2xldCBiPU9iamVjdC5lbnRyaWVzKGNvbmZpZy5uZXR3b3JrcykuZmluZChiPT57bGV0W2MsZF09YjtpZihkLmNoYWluX2lkPT09YSlyZXR1cm4gY29uZmlnLm5ldHdvcmtfbmFtZT1jLGQuYWRkcmVzc19wcmVmaXgmJihjb25maWcuYWRkcmVzc19wcmVmaXg9ZC5hZGRyZXNzX3ByZWZpeCksITB9KTtyZXR1cm4gYj97bmV0d29ya19uYW1lOmJbMF0sbmV0d29yazpiWzFdfTp2b2lkIGNvbnNvbGUubG9nKFwiVW5rbm93biBjaGFpbiBpZCAodGhpcyBtYXkgYmUgYSB0ZXN0bmV0KVwiLGEpfSxyZXNldDooKT0+e2NvbmZpZy5jb3JlX2Fzc2V0PVwiQ09SRVwiLGNvbmZpZy5hZGRyZXNzX3ByZWZpeD1cIkdQSFwiLGNvbmZpZy5leHBpcmVfaW5fc2Vjcz0xNSxjb25maWcuZXhwaXJlX2luX3NlY3NfcHJvcG9zYWw9ODY0MDAsY29uc29sZS5sb2coXCJDaGFpbiBjb25maWcgcmVzZXRcIil9LHNldFByZWZpeDpmdW5jdGlvbigpe2xldCBhPTA8YXJndW1lbnRzLmxlbmd0aCYmYXJndW1lbnRzWzBdIT09dm9pZCAwP2FyZ3VtZW50c1swXTpcIkdQSFwiO3JldHVybiBjb25maWcuYWRkcmVzc19wcmVmaXg9YX19LF9kZWZhdWx0PWNvbmZpZztleHBvcnRzLmRlZmF1bHQ9X2RlZmF1bHQ7IiwiXCJ1c2Ugc3RyaWN0XCI7dmFyIF9pc29tb3JwaGljV3M9X2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKFwiaXNvbW9ycGhpYy13c1wiKSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSksZXhwb3J0cy5kZWZhdWx0PXZvaWQgMDtmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KGEpe3JldHVybiBhJiZhLl9fZXNNb2R1bGU/YTp7ZGVmYXVsdDphfX1mdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkoYSxiLGMpe3JldHVybiBiPV90b1Byb3BlcnR5S2V5KGIpLGIgaW4gYT9PYmplY3QuZGVmaW5lUHJvcGVydHkoYSxiLHt2YWx1ZTpjLGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwLHdyaXRhYmxlOiEwfSk6YVtiXT1jLGF9ZnVuY3Rpb24gX3RvUHJvcGVydHlLZXkoYSl7dmFyIGI9X3RvUHJpbWl0aXZlKGEsXCJzdHJpbmdcIik7cmV0dXJuXCJzeW1ib2xcIj09dHlwZW9mIGI/YjpiK1wiXCJ9ZnVuY3Rpb24gX3RvUHJpbWl0aXZlKGEsYil7aWYoXCJvYmplY3RcIiE9dHlwZW9mIGF8fG51bGw9PT1hKXJldHVybiBhO3ZhciBjPWFbU3ltYm9sLnRvUHJpbWl0aXZlXTtpZihjIT09dm9pZCAwKXt2YXIgZD1jLmNhbGwoYSxifHxcImRlZmF1bHRcIik7aWYoXCJvYmplY3RcIiE9dHlwZW9mIGQpcmV0dXJuIGQ7dGhyb3cgbmV3IFR5cGVFcnJvcihcIkBAdG9QcmltaXRpdmUgbXVzdCByZXR1cm4gYSBwcmltaXRpdmUgdmFsdWUuXCIpfXJldHVybihcInN0cmluZ1wiPT09Yj9TdHJpbmc6TnVtYmVyKShhKX1jb25zdCBTT0NLRVRfREVCVUc9ITEsTUFYX1NFTkRfTElGRT01LE1BWF9SRUNWX0xJRkU9MipNQVhfU0VORF9MSUZFO2NsYXNzIENoYWluV2ViU29ja2V0e2NvbnN0cnVjdG9yKGEsYil7bGV0IGM9Mjxhcmd1bWVudHMubGVuZ3RoJiZhcmd1bWVudHNbMl0hPT12b2lkIDA/YXJndW1lbnRzWzJdOjVlMyxkPSEoMzxhcmd1bWVudHMubGVuZ3RoJiZhcmd1bWVudHNbM10hPT12b2lkIDApfHxhcmd1bWVudHNbM10sZT00PGFyZ3VtZW50cy5sZW5ndGgmJmFyZ3VtZW50c1s0XSE9PXZvaWQgMD9hcmd1bWVudHNbNF06bnVsbDtfZGVmaW5lUHJvcGVydHkodGhpcyxcImNvbm5lY3RcIiwoYSxiKT0+bmV3IFByb21pc2UoKGMsZCk9Pnt0aGlzLmN1cnJlbnRfcmVqZWN0PWQsdGhpcy5jdXJyZW50X3Jlc29sdmU9Yzt0cnl7dGhpcy53cz1uZXcgX2lzb21vcnBoaWNXcy5kZWZhdWx0KGEpfWNhdGNoKGIpey8vIERJU0NPTk5FQ1RFRFxudGhpcy53cz17cmVhZHlTdGF0ZTozLGNsb3NlOigpPT57fX0sZChuZXcgRXJyb3IoXCJJbnZhbGlkIHVybFwiLGEsXCIgY2xvc2VkXCIpKX10aGlzLndzLm9ub3Blbj10aGlzLm9uT3Blbix0aGlzLndzLm9uZXJyb3I9dGhpcy5vbkVycm9yLHRoaXMud3Mub25tZXNzYWdlPXRoaXMub25NZXNzYWdlLHRoaXMud3Mub25jbG9zZT10aGlzLm9uQ2xvc2UsdGhpcy5jb25uZWN0aW9uVGltZW91dD1zZXRUaW1lb3V0KCgpPT57dGhpcy5jdXJyZW50X3JlamVjdCYmKHRoaXMuY3VycmVudF9yZWplY3Q9bnVsbCx0aGlzLmNsb3NlKCksZChuZXcgRXJyb3IoXCJDb25uZWN0aW9uIGF0dGVtcHQgdGltZWQgb3V0IGFmdGVyIFwiK2IvMWUzK1wic1wiKSkpfSxiKX0pKSxfZGVmaW5lUHJvcGVydHkodGhpcyxcIm9uT3BlblwiLCgpPT57Y2xlYXJUaW1lb3V0KHRoaXMuY29ubmVjdGlvblRpbWVvdXQpLHRoaXMuc3RhdHVzQ2ImJnRoaXMuc3RhdHVzQ2IoXCJvcGVuXCIpLHRoaXMub25fcmVjb25uZWN0JiZ0aGlzLm9uX3JlY29ubmVjdCgpLHRoaXMua2VlcGFsaXZlX3RpbWVyPXNldEludGVydmFsKCgpPT4odGhpcy5yZWN2X2xpZmUtLSwwPT10aGlzLnJlY3ZfbGlmZT8oY29uc29sZS5lcnJvcih0aGlzLnVybCtcIiBjb25uZWN0aW9uIGlzIGRlYWQsIHRlcm1pbmF0aW5nIHdzXCIpLHZvaWQgdGhpcy5jbG9zZSgpKTp2b2lkKHRoaXMuc2VuZF9saWZlLS0sMD09dGhpcy5zZW5kX2xpZmUmJih0aGlzLmtlZXBBbGl2ZUNiJiZ0aGlzLmtlZXBBbGl2ZUNiKHRoaXMuY2xvc2VkKSx0aGlzLnNlbmRfbGlmZT1NQVhfU0VORF9MSUZFKSkpLDVlMyksdGhpcy5jdXJyZW50X3JlamVjdD1udWxsLHRoaXMuY3VycmVudF9yZXNvbHZlKCl9KSxfZGVmaW5lUHJvcGVydHkodGhpcyxcIm9uRXJyb3JcIixhPT57dGhpcy5rZWVwYWxpdmVfdGltZXImJihjbGVhckludGVydmFsKHRoaXMua2VlcGFsaXZlX3RpbWVyKSx0aGlzLmtlZXBhbGl2ZV90aW1lcj12b2lkIDApLGNsZWFyVGltZW91dCh0aGlzLmNvbm5lY3Rpb25UaW1lb3V0KSx0aGlzLnN0YXR1c0NiJiZ0aGlzLnN0YXR1c0NiKFwiZXJyb3JcIiksdGhpcy5jdXJyZW50X3JlamVjdCYmdGhpcy5jdXJyZW50X3JlamVjdChhKX0pLF9kZWZpbmVQcm9wZXJ0eSh0aGlzLFwib25NZXNzYWdlXCIsYT0+e3RoaXMucmVjdl9saWZlPU1BWF9SRUNWX0xJRkUsdGhpcy5saXN0ZW5lcihKU09OLnBhcnNlKGEuZGF0YSkpfSksX2RlZmluZVByb3BlcnR5KHRoaXMsXCJvbkNsb3NlXCIsKCk9Pnt0aGlzLmNsb3NlZD0hMCx0aGlzLmtlZXBhbGl2ZV90aW1lciYmKGNsZWFySW50ZXJ2YWwodGhpcy5rZWVwYWxpdmVfdGltZXIpLHRoaXMua2VlcGFsaXZlX3RpbWVyPXZvaWQgMCk7Zm9yKHZhciBhPXRoaXMucmVzcG9uc2VDYklkKzE7YTw9dGhpcy5jYklkO2ErPTEpdGhpcy5jYnNbYV0ucmVqZWN0KG5ldyBFcnJvcihcImNvbm5lY3Rpb24gY2xvc2VkXCIpKTt0aGlzLnN0YXR1c0NiJiZ0aGlzLnN0YXR1c0NiKFwiY2xvc2VkXCIpLHRoaXMuX2Nsb3NlQ2ImJnRoaXMuX2Nsb3NlQ2IoKSx0aGlzLm9uX2Nsb3NlJiZ0aGlzLm9uX2Nsb3NlKCl9KSxfZGVmaW5lUHJvcGVydHkodGhpcyxcImNhbGxcIixhPT57aWYoMSE9PXRoaXMud3MucmVhZHlTdGF0ZSlyZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKFwid2Vic29ja2V0IHN0YXRlIGVycm9yOlwiK3RoaXMud3MucmVhZHlTdGF0ZSkpO2xldCBiPWFbMV07aWYoU09DS0VUX0RFQlVHJiZjb25zb2xlLmxvZyhcIltDaGFpbldlYlNvY2tldF0gPi0tLS0gY2FsbCAtLS0tLT4gIFxcXCJpZFxcXCI6XCIrKHRoaXMuY2JJZCsxKSxKU09OLnN0cmluZ2lmeShhKSksdGhpcy5jYklkKz0xLFtcInNldF9zdWJzY3JpYmVfY2FsbGJhY2tcIixcInN1YnNjcmliZV90b19tYXJrZXRcIixcImJyb2FkY2FzdF90cmFuc2FjdGlvbl93aXRoX2NhbGxiYWNrXCIsXCJzZXRfcGVuZGluZ190cmFuc2FjdGlvbl9jYWxsYmFja1wiLFwic2V0X2Jsb2NrX2FwcGxpZWRfY2FsbGJhY2tcIl0uaW5jbHVkZXMoYikmJih0aGlzLnN1YnNbdGhpcy5jYklkXT17Y2FsbGJhY2s6YVsyXVswXX0sYVsyXVswXT10aGlzLmNiSWQpLFtcInVuc3Vic2NyaWJlX2Zyb21fbWFya2V0XCIsXCJ1bnN1YnNjcmliZV9mcm9tX2FjY291bnRzXCJdLmluY2x1ZGVzKGIpKXtpZihcImZ1bmN0aW9uXCIhPXR5cGVvZiBhWzJdWzBdKXRocm93IG5ldyBFcnJvcihcIkZpcnN0IHBhcmFtZXRlciBvZiB1bnN1YiBtdXN0IGJlIHRoZSBvcmlnaW5hbCBjYWxsYmFja1wiKTtsZXQgYj1hWzJdLnNwbGljZSgwLDEpWzBdOy8vIEZpbmQgdGhlIGNvcnJlc3BvbmRpbmcgc3Vic2NyaXB0aW9uXG5mb3IobGV0IGEgaW4gdGhpcy5zdWJzKWlmKHRoaXMuc3Vic1thXS5jYWxsYmFjaz09PWIpe3RoaXMudW5zdWJbdGhpcy5jYklkXT1hO2JyZWFrfX12YXIgYz17bWV0aG9kOlwiY2FsbFwiLHBhcmFtczphfTtyZXR1cm4gYy5pZD10aGlzLmNiSWQsdGhpcy5zZW5kX2xpZmU9TUFYX1NFTkRfTElGRSxuZXcgUHJvbWlzZSgoYSxiKT0+e3RoaXMuY2JzW3RoaXMuY2JJZF09e3RpbWU6bmV3IERhdGUscmVzb2x2ZTphLHJlamVjdDpifSx0aGlzLndzLnNlbmQoSlNPTi5zdHJpbmdpZnkoYykpfSl9KSxfZGVmaW5lUHJvcGVydHkodGhpcyxcImxpc3RlbmVyXCIsYT0+e1NPQ0tFVF9ERUJVRyYmY29uc29sZS5sb2coXCJbQ2hhaW5XZWJTb2NrZXRdIDwtLS0tIHJlcGx5IC0tLS08XCIsSlNPTi5zdHJpbmdpZnkoYSkpO2xldCBiPSExLGM9bnVsbDtcIm5vdGljZVwiPT09YS5tZXRob2QmJihiPSEwLGEuaWQ9YS5wYXJhbXNbMF0pLGI/Yz10aGlzLnN1YnNbYS5pZF0uY2FsbGJhY2s6KGM9dGhpcy5jYnNbYS5pZF0sdGhpcy5yZXNwb25zZUNiSWQ9YS5pZCksYyYmIWI/KGEuZXJyb3I/Yy5yZWplY3QoYS5lcnJvcik6Yy5yZXNvbHZlKGEucmVzdWx0KSxkZWxldGUgdGhpcy5jYnNbYS5pZF0sdGhpcy51bnN1YlthLmlkXSYmKGRlbGV0ZSB0aGlzLnN1YnNbdGhpcy51bnN1YlthLmlkXV0sZGVsZXRlIHRoaXMudW5zdWJbYS5pZF0pKTpjJiZiP2MoYS5wYXJhbXNbMV0pOmNvbnNvbGUubG9nKFwiV2FybmluZzogdW5rbm93biB3ZWJzb2NrZXQgcmVzcG9uc2U6IFwiLGEpfSksX2RlZmluZVByb3BlcnR5KHRoaXMsXCJsb2dpblwiLChhLGIpPT50aGlzLmNvbm5lY3RfcHJvbWlzZS50aGVuKCgpPT50aGlzLmNhbGwoWzEsXCJsb2dpblwiLFthLGJdXSkpKSxfZGVmaW5lUHJvcGVydHkodGhpcyxcImNsb3NlXCIsKCk9Pm5ldyBQcm9taXNlKGE9PihjbGVhckludGVydmFsKHRoaXMua2VlcGFsaXZlX3RpbWVyKSx0aGlzLmtlZXBhbGl2ZV90aW1lcj12b2lkIDAsdGhpcy5fY2xvc2VDYj0oKT0+e2EoKSx0aGlzLl9jbG9zZUNiPW51bGx9LHRoaXMud3M/dm9pZCh0aGlzLndzLnRlcm1pbmF0ZT90aGlzLndzLnRlcm1pbmF0ZSgpOnRoaXMud3MuY2xvc2UoKSwzPT09dGhpcy53cy5yZWFkeVN0YXRlJiZhKCkpOihjb25zb2xlLmxvZyhcIldlYnNvY2tldCBhbHJlYWR5IGNsZWFyZWRcIix0aGlzKSxhKCkpKSkpLHRoaXMudXJsPWEsdGhpcy5zdGF0dXNDYj1iLHRoaXMuY3VycmVudF9yZWplY3Q9bnVsbCx0aGlzLm9uX3JlY29ubmVjdD1udWxsLHRoaXMuY2xvc2VkPSExLHRoaXMuc2VuZF9saWZlPU1BWF9TRU5EX0xJRkUsdGhpcy5yZWN2X2xpZmU9TUFYX1JFQ1ZfTElGRSx0aGlzLmtlZXBBbGl2ZUNiPWUsdGhpcy5jYklkPTAsdGhpcy5yZXNwb25zZUNiSWQ9MCx0aGlzLmNicz17fSx0aGlzLnN1YnM9e30sdGhpcy51bnN1Yj17fSx0aGlzLmNvbm5lY3RfcHJvbWlzZT10aGlzLmNvbm5lY3QoYSxjKX19dmFyIF9kZWZhdWx0PUNoYWluV2ViU29ja2V0O2V4cG9ydHMuZGVmYXVsdD1fZGVmYXVsdDsiLCJcInVzZSBzdHJpY3RcIjtPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cyxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KSxleHBvcnRzLmRlZmF1bHQ9dm9pZCAwO3ZhciBBcGlzPV9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKHJlcXVpcmUoXCIuL0FwaUluc3RhbmNlc1wiKSksX0NoYWluV2ViU29ja2V0PV9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vQ2hhaW5XZWJTb2NrZXRcIikpO2Z1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoYSl7cmV0dXJuIGEmJmEuX19lc01vZHVsZT9hOntkZWZhdWx0OmF9fWZ1bmN0aW9uIF9nZXRSZXF1aXJlV2lsZGNhcmRDYWNoZShhKXtpZihcImZ1bmN0aW9uXCIhPXR5cGVvZiBXZWFrTWFwKXJldHVybiBudWxsO3ZhciBiPW5ldyBXZWFrTWFwLGM9bmV3IFdlYWtNYXA7cmV0dXJuKF9nZXRSZXF1aXJlV2lsZGNhcmRDYWNoZT1mdW5jdGlvbihhKXtyZXR1cm4gYT9jOmJ9KShhKX1mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChhLGIpe2lmKCFiJiZhJiZhLl9fZXNNb2R1bGUpcmV0dXJuIGE7aWYobnVsbD09PWF8fFwib2JqZWN0XCIhPXR5cGVvZiBhJiZcImZ1bmN0aW9uXCIhPXR5cGVvZiBhKXJldHVybntkZWZhdWx0OmF9O3ZhciBjPV9nZXRSZXF1aXJlV2lsZGNhcmRDYWNoZShiKTtpZihjJiZjLmhhcyhhKSlyZXR1cm4gYy5nZXQoYSk7dmFyIGQ9e30sZT1PYmplY3QuZGVmaW5lUHJvcGVydHkmJk9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3I7Zm9yKHZhciBmIGluIGEpaWYoXCJkZWZhdWx0XCIhPWYmJk9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChhLGYpKXt2YXIgZz1lP09iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoYSxmKTpudWxsO2cmJihnLmdldHx8Zy5zZXQpP09iamVjdC5kZWZpbmVQcm9wZXJ0eShkLGYsZyk6ZFtmXT1hW2ZdfXJldHVybiBkLmRlZmF1bHQ9YSxjJiZjLnNldChhLGQpLGR9ZnVuY3Rpb24gX2RlZmluZVByb3BlcnR5KGEsYixjKXtyZXR1cm4gYj1fdG9Qcm9wZXJ0eUtleShiKSxiIGluIGE/T2JqZWN0LmRlZmluZVByb3BlcnR5KGEsYix7dmFsdWU6YyxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMCx3cml0YWJsZTohMH0pOmFbYl09YyxhfWZ1bmN0aW9uIF90b1Byb3BlcnR5S2V5KGEpe3ZhciBiPV90b1ByaW1pdGl2ZShhLFwic3RyaW5nXCIpO3JldHVyblwic3ltYm9sXCI9PXR5cGVvZiBiP2I6YitcIlwifWZ1bmN0aW9uIF90b1ByaW1pdGl2ZShhLGIpe2lmKFwib2JqZWN0XCIhPXR5cGVvZiBhfHxudWxsPT09YSlyZXR1cm4gYTt2YXIgYz1hW1N5bWJvbC50b1ByaW1pdGl2ZV07aWYoYyE9PXZvaWQgMCl7dmFyIGQ9Yy5jYWxsKGEsYnx8XCJkZWZhdWx0XCIpO2lmKFwib2JqZWN0XCIhPXR5cGVvZiBkKXJldHVybiBkO3Rocm93IG5ldyBUeXBlRXJyb3IoXCJAQHRvUHJpbWl0aXZlIG11c3QgcmV0dXJuIGEgcHJpbWl0aXZlIHZhbHVlLlwiKX1yZXR1cm4oXCJzdHJpbmdcIj09PWI/U3RyaW5nOk51bWJlcikoYSl9Y2xhc3MgTWFuYWdlcntjb25zdHJ1Y3RvcihhKXt2YXIgYj10aGlzO2xldHt1cmw6Yyx1cmxzOmQsYXV0b0ZhbGxiYWNrOmUsY2xvc2VDYjpmLG9wdGlvbmFsQXBpczpnLHVybENoYW5nZUNhbGxiYWNrOmh9PWE7X2RlZmluZVByb3BlcnR5KHRoaXMsXCJzZXRDbG9zZUNiXCIsYT0+e3RoaXMuY2xvc2VDYj1hfSksX2RlZmluZVByb3BlcnR5KHRoaXMsXCJsb2dGYWlsdXJlXCIsKGEsYixjKT0+e2xldCBkPWMmJmMubWVzc2FnZT9jLm1lc3NhZ2U6XCJcIjtjb25zb2xlLmVycm9yKGEsXCJGYWlsZWQgdG8gY29ubmVjdCB0byBcIitiKyhkP1wiIEVycm9yOiBcIitKU09OLnN0cmluZ2lmeShkKTpcIlwiKSl9KSxfZGVmaW5lUHJvcGVydHkodGhpcyxcIl9vbkNsb3NlXCIsKCk9Pnt0aGlzLmlzQ29ubmVjdGVkPSExLHRoaXMuY2xvc2VDYiYmKHRoaXMuY2xvc2VDYigpLHRoaXMuc2V0Q2xvc2VDYihudWxsKSksdGhpcy5hdXRvRmFsbGJhY2smJnRoaXMuY29ubmVjdFdpdGhGYWxsYmFjaygpfSksX2RlZmluZVByb3BlcnR5KHRoaXMsXCJjb25uZWN0XCIsYXN5bmMgZnVuY3Rpb24oKXtsZXQgYT0hKDA8YXJndW1lbnRzLmxlbmd0aCYmYXJndW1lbnRzWzBdIT09dm9pZCAwKXx8YXJndW1lbnRzWzBdLGM9MTxhcmd1bWVudHMubGVuZ3RoJiZhcmd1bWVudHNbMV0hPT12b2lkIDA/YXJndW1lbnRzWzFdOmIudXJsO3RyeXtsZXQgZD1hd2FpdCBBcGlzLmluc3RhbmNlKGMsYSx2b2lkIDAsYi5vcHRpb25hbEFwaXMsYi5fb25DbG9zZSkuaW5pdF9wcm9taXNlO3JldHVybiBiLnVybD1jLGIuaXNDb25uZWN0ZWQ9ITAsZH1jYXRjaChhKXt0aHJvdyBhd2FpdCBBcGlzLmNsb3NlKCksYX19KSxfZGVmaW5lUHJvcGVydHkodGhpcyxcImNvbm5lY3RXaXRoRmFsbGJhY2tcIixhc3luYyBmdW5jdGlvbigpe2xldCBhPSEoMDxhcmd1bWVudHMubGVuZ3RoJiZhcmd1bWVudHNbMF0hPT12b2lkIDApfHxhcmd1bWVudHNbMF0sYz0xPGFyZ3VtZW50cy5sZW5ndGgmJmFyZ3VtZW50c1sxXSE9PXZvaWQgMD9hcmd1bWVudHNbMV06Yi51cmwsZD0yPGFyZ3VtZW50cy5sZW5ndGgmJmFyZ3VtZW50c1syXSE9PXZvaWQgMD9hcmd1bWVudHNbMl06MCxlPTM8YXJndW1lbnRzLmxlbmd0aCYmYXJndW1lbnRzWzNdIT09dm9pZCAwP2FyZ3VtZW50c1szXTpudWxsLGY9NDxhcmd1bWVudHMubGVuZ3RoJiZhcmd1bWVudHNbNF0hPT12b2lkIDA/YXJndW1lbnRzWzRdOm51bGw7aWYoZD5iLnVybHMubGVuZ3RoKXJldHVybiBmKG5ldyBFcnJvcihcIlRyaWVkIFwiK2QrXCIgY29ubmVjdGlvbnMsIG5vbmUgb2Ygd2hpY2ggd29ya2VkOiBcIitKU09OLnN0cmluZ2lmeShiLnVybHMuY29uY2F0KGIudXJsKSkpKTt0cnl7cmV0dXJuIGF3YWl0IGIuY29ubmVjdChhLGMpfWNhdGNoKGMpe3JldHVybiBiLnVybENoYW5nZUNhbGxiYWNrJiZiLnVybENoYW5nZUNhbGxiYWNrKGIudXJsc1tkXSksYi5jb25uZWN0V2l0aEZhbGxiYWNrKGEsYi51cmxzW2RdLGQrMSxlLGYpfX0pLF9kZWZpbmVQcm9wZXJ0eSh0aGlzLFwiY2hlY2tDb25uZWN0aW9uc1wiLGFzeW5jIGZ1bmN0aW9uKCl7bGV0IGE9MDxhcmd1bWVudHMubGVuZ3RoJiZhcmd1bWVudHNbMF0hPT12b2lkIDA/YXJndW1lbnRzWzBdOlwiXCIsYz0xPGFyZ3VtZW50cy5sZW5ndGgmJmFyZ3VtZW50c1sxXSE9PXZvaWQgMD9hcmd1bWVudHNbMV06XCJcIixkPTI8YXJndW1lbnRzLmxlbmd0aD9hcmd1bWVudHNbMl06dm9pZCAwLGU9Mzxhcmd1bWVudHMubGVuZ3RoP2FyZ3VtZW50c1szXTp2b2lkIDAsZj17fSxnPWIudXJscy5jb25jYXQoYi51cmwpLGg9Zy5tYXAoYXN5bmMgZD0+ey8qIFVzZSBkZWZhdWx0IHRpbWVvdXQgYW5kIG5vIHJlY29ubmVjdGluZy13ZWJzb2NrZXQgKi9sZXQgZT1uZXcgX0NoYWluV2ViU29ja2V0LmRlZmF1bHQoZCwoKT0+e30sdm9pZCAwLCExKTtmW2RdPW5ldyBEYXRlKCkuZ2V0VGltZSgpO3RyeXthd2FpdCBlLmxvZ2luKGEsYyk7bGV0IGI9e1tkXTpuZXcgRGF0ZSgpLmdldFRpbWUoKS1mW2RdfTtyZXR1cm4gYXdhaXQgZS5jbG9zZSgpLGJ9Y2F0Y2goYSl7cmV0dXJuIGQ9PT1iLnVybD9iLnVybD1iLnVybHNbMF06Yi51cmxzPWIudXJscy5maWx0ZXIoYj0+YiE9PWQpLHZvaWQoYXdhaXQgZS5jbG9zZSgpKX19KTt0cnl7bGV0IGE9YXdhaXQgUHJvbWlzZS5hbGwoaCksYj1hLmZpbHRlcihiPT4hIWIpLnNvcnQoKGMsYSk9Pk9iamVjdC52YWx1ZXMoYylbMF0tT2JqZWN0LnZhbHVlcyhhKVswXSkucmVkdWNlKChiLGMpPT57bGV0IGE9T2JqZWN0LmtleXMoYylbMF07cmV0dXJuIGJbYV09Y1thXSxifSx7fSk7cmV0dXJuIGNvbnNvbGUubG9nKGBDaGVja2VkICR7YS5sZW5ndGh9IGNvbm5lY3Rpb25zLCAke2EubGVuZ3RoLU9iamVjdC5rZXlzKGIpLmxlbmd0aH0gZmFpbGVkYCksYn1jYXRjaChmKXtyZXR1cm4gYi5jaGVja0Nvbm5lY3Rpb25zKGEsYyxkLGUpfX0pLHRoaXMudXJsPWMsdGhpcy51cmxzPWQuZmlsdGVyKGI9PmIhPT1jKSx0aGlzLmF1dG9GYWxsYmFjaz1lLHRoaXMuY2xvc2VDYj1mLHRoaXMub3B0aW9uYWxBcGlzPWd8fHt9LHRoaXMuaXNDb25uZWN0ZWQ9ITEsdGhpcy51cmxDaGFuZ2VDYWxsYmFjaz1ofXN0YXRpYyBjbG9zZSgpe3JldHVybiBBcGlzLmNsb3NlKCl9fXZhciBfZGVmYXVsdD1NYW5hZ2VyO2V4cG9ydHMuZGVmYXVsdD1fZGVmYXVsdDsiLCJcInVzZSBzdHJpY3RcIjtPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cyxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KSxleHBvcnRzLmRlZmF1bHQ9dm9pZCAwO2NsYXNzIEdyYXBoZW5lQXBpe2NvbnN0cnVjdG9yKGEsYil7dGhpcy53c19ycGM9YSx0aGlzLmFwaV9uYW1lPWJ9aW5pdCgpe3ZhciBhPXRoaXM7cmV0dXJuIHRoaXMud3NfcnBjLmNhbGwoWzEsdGhpcy5hcGlfbmFtZSxbXV0pLnRoZW4oYj0+KGEuYXBpX2lkPWIsYSkpfWV4ZWMoYSxiKXtyZXR1cm4gdGhpcy53c19ycGMuY2FsbChbdGhpcy5hcGlfaWQsYSxiXSkuY2F0Y2goYT0+ey8vIGNvbnNvbGUubG9nKFwiISEhIEdyYXBoZW5lQXBpIGVycm9yOiBcIiwgbWV0aG9kLCBwYXJhbXMsIGVycm9yLCBKU09OLnN0cmluZ2lmeShlcnJvcikpO1xudGhyb3cgYX0pfX12YXIgX2RlZmF1bHQ9R3JhcGhlbmVBcGk7ZXhwb3J0cy5kZWZhdWx0PV9kZWZhdWx0OyIsIlwidXNlIHN0cmljdFwiO3ZhciBBcGlzPV9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKHJlcXVpcmUoXCIuL0FwaUluc3RhbmNlc1wiKSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSksZXhwb3J0cy5BcGlzPXZvaWQgMCxPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cyxcIkNoYWluQ29uZmlnXCIse2VudW1lcmFibGU6ITAsZ2V0OmZ1bmN0aW9uKCl7cmV0dXJuIF9DaGFpbkNvbmZpZy5kZWZhdWx0fX0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLFwiTWFuYWdlclwiLHtlbnVtZXJhYmxlOiEwLGdldDpmdW5jdGlvbigpe3JldHVybiBfQ29ubmVjdGlvbk1hbmFnZXIuZGVmYXVsdH19KTtleHBvcnRzLkFwaXM9QXBpczt2YXIgX0Nvbm5lY3Rpb25NYW5hZ2VyPV9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZShcIi4vQ29ubmVjdGlvbk1hbmFnZXJcIikpLF9DaGFpbkNvbmZpZz1faW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoXCIuL0NoYWluQ29uZmlnXCIpKTtmdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KGEpe3JldHVybiBhJiZhLl9fZXNNb2R1bGU/YTp7ZGVmYXVsdDphfX1mdW5jdGlvbiBfZ2V0UmVxdWlyZVdpbGRjYXJkQ2FjaGUoYSl7aWYoXCJmdW5jdGlvblwiIT10eXBlb2YgV2Vha01hcClyZXR1cm4gbnVsbDt2YXIgYj1uZXcgV2Vha01hcCxjPW5ldyBXZWFrTWFwO3JldHVybihfZ2V0UmVxdWlyZVdpbGRjYXJkQ2FjaGU9ZnVuY3Rpb24oYSl7cmV0dXJuIGE/YzpifSkoYSl9ZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQoYSxiKXtpZighYiYmYSYmYS5fX2VzTW9kdWxlKXJldHVybiBhO2lmKG51bGw9PT1hfHxcIm9iamVjdFwiIT10eXBlb2YgYSYmXCJmdW5jdGlvblwiIT10eXBlb2YgYSlyZXR1cm57ZGVmYXVsdDphfTt2YXIgYz1fZ2V0UmVxdWlyZVdpbGRjYXJkQ2FjaGUoYik7aWYoYyYmYy5oYXMoYSkpcmV0dXJuIGMuZ2V0KGEpO3ZhciBkPXt9LGU9T2JqZWN0LmRlZmluZVByb3BlcnR5JiZPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yO2Zvcih2YXIgZiBpbiBhKWlmKFwiZGVmYXVsdFwiIT1mJiZPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYSxmKSl7dmFyIGc9ZT9PYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKGEsZik6bnVsbDtnJiYoZy5nZXR8fGcuc2V0KT9PYmplY3QuZGVmaW5lUHJvcGVydHkoZCxmLGcpOmRbZl09YVtmXX1yZXR1cm4gZC5kZWZhdWx0PWEsYyYmYy5zZXQoYSxkKSxkfSIsIi8vIGh0dHBzOi8vZ2l0aHViLmNvbS9tYXhvZ2Rlbi93ZWJzb2NrZXQtc3RyZWFtL2Jsb2IvNDhkYzNkZGY5NDNlNWFkYTY2OGMzMWNjZDk0ZTkxODZmMDJmYWZiZC93cy1mYWxsYmFjay5qc1xuXG52YXIgd3MgPSBudWxsXG5cbmlmICh0eXBlb2YgV2ViU29ja2V0ICE9PSAndW5kZWZpbmVkJykge1xuICB3cyA9IFdlYlNvY2tldFxufSBlbHNlIGlmICh0eXBlb2YgTW96V2ViU29ja2V0ICE9PSAndW5kZWZpbmVkJykge1xuICB3cyA9IE1veldlYlNvY2tldFxufSBlbHNlIGlmICh0eXBlb2YgZ2xvYmFsICE9PSAndW5kZWZpbmVkJykge1xuICB3cyA9IGdsb2JhbC5XZWJTb2NrZXQgfHwgZ2xvYmFsLk1veldlYlNvY2tldFxufSBlbHNlIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xuICB3cyA9IHdpbmRvdy5XZWJTb2NrZXQgfHwgd2luZG93Lk1veldlYlNvY2tldFxufSBlbHNlIGlmICh0eXBlb2Ygc2VsZiAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgd3MgPSBzZWxmLldlYlNvY2tldCB8fCBzZWxmLk1veldlYlNvY2tldFxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHdzXG4iXX0=
